<!--
  Generated template for the CharacterSheetPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
    <ion-navbar color="primary">
        <button ion-button menuToggle>
            <ion-icon name="menu"></ion-icon>
        </button>
        <ion-title>{{ ( character | async )?.name }}</ion-title>
    </ion-navbar>
</ion-header>

<ion-content>
    <ion-list class="listFixer">
        <ion-item-sliding *ngFor="let stat of (stats | async); let i = index">
            <ion-item class="itemFixer">
                <ion-grid class="statWrapper">
                    <div *ngIf="(selectedStatId | async) === stat.id; then editMode else viewMode"></div>
                    <ng-template #viewMode>
                        <ion-row col-12 (click)="selectStat(stat, i)" class="stat" [ngClass]="{'visible': getVis(stat.value, stat.maximum)}">
                            <ion-col col-5 class="name">
                                {{ stat.name }}
                            </ion-col>
                            <ion-col col-3 class="valueWrapper">
                                <span class="value">
                        {{ stat.value }}
                    </span>
                                <span class="maximum">
                        {{ stat.maximum }}
                    </span>
                            </ion-col>
                            <ion-col col-4 text-right class="type">
                                {{ stat.type }}
                            </ion-col>
                        </ion-row>
                    </ng-template>
                    <ng-template #editMode>
                        <form [formGroup]="editStatForm" style="width: 100%;">
                            <ion-grid style="border: 1px solid red;">
                                <ion-row style="background-color: red;">
                                    <ion-col col-12 style="color:white">Edit Stat</ion-col>
                                </ion-row>
                                <ion-row>
                                    <ion-col col-12>
                                        <ion-input style="border-bottom: 1px solid red;" text-right type="text" name="name" formControlName="name"></ion-input>
                                    </ion-col>
                                </ion-row>
                                <ion-row>
                                    <ion-col col-12>
                                        <ion-input style="border-bottom: 1px solid red;" text-right type="text" type="number" name="value" formControlName="value"></ion-input>
                                    </ion-col>
                                </ion-row>
                                <ion-row>
                                    <ion-col col-12>
                                        <ion-input style="border-bottom: 1px solid red;" text-right type="text" type="number" name="maximum" formControlName="maximum"></ion-input>
                                    </ion-col>
                                </ion-row>
                                <ion-row>
                                    <ion-col col-12>
                                        <ion-input style="border-bottom: 1px solid red;" text-right type="text" type="text" name="type" formControlName="type"></ion-input>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </form>
                    </ng-template>
                </ion-grid>
            </ion-item>
            <ion-item-options *ngIf="stat.maximum > 0 && stat.value < stat.maximum" side="left">
                <button ion-button color="secondary" (click)="refresh(stat)">
                    <ion-icon name="refresh-circle">                          
                    </ion-icon>
                    Refresh
                </button>
            </ion-item-options>
            <ion-item-options side="right">
                <button ion-button color="danger" (click)="trash(stat)">
                    <ion-icon name="trash">
                    </ion-icon>
                    Remove
                </button>
            </ion-item-options>
        </ion-item-sliding>
    </ion-list>
</ion-content>

<ion-footer>
    <ion-toolbar color="primary" no-padding>
        <ion-grid>
            <div *ngIf="btnView === false; then addMode else changeMode"></div>
            <ng-template #addMode>
                <ion-row>
                    <ion-col col-12>
                        <button ion-button full (click)="createStat()" type="button" color="secondary">Add Stat</button>
                    </ion-col>
                </ion-row>
            </ng-template>
            <ng-template #changeMode>
                <ion-row>
                    <ion-col col-6>
                        <button ion-button full (click)="removeStat()" type="button" color="danger">Remove</button>
                    </ion-col>
                    <ion-col col-6>
                        <button ion-button full (click)="updateStat()" type="button" color="secondary">Update</button>
                    </ion-col>
                </ion-row>
            </ng-template>
        </ion-grid>
    </ion-toolbar>
</ion-footer>