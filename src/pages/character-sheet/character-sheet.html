<ion-header [ngStyle]="{'background-color': (currentStat | async) ? 'red' : '#488aff' }">
    <div *ngIf="(currentStat | async); then titleEdit else titleAdd"></div>
    <ng-template #titleAdd>
        <ion-navbar [@charTitle]>
            <button ion-button menuToggle>
                <ion-icon name="menu"></ion-icon>
            </button>
            <ion-title>{{ ( character | async )?.name }}</ion-title>
            <ion-buttons end>
                <button ion-button icon-only (click)="createStat()">
                    <ion-icon name="add">
                    </ion-icon>
                </button>
            </ion-buttons>
        </ion-navbar>
    </ng-template>
    <ng-template #titleEdit>
        <ion-navbar class="editHeader" [@statTitle]>
            <ion-title>{{ ( currentStat | async )?.name }}</ion-title>
            <ion-buttons end>
                <button ion-button icon-only (click)="editStat()">
                     <ion-icon name="open">
                     </ion-icon>
                </button>
                <button ion-button icon-only (click)="unselectStat()">
                    <ion-icon name="close">
                    </ion-icon>
                </button>
            </ion-buttons>
        </ion-navbar>
    </ng-template>
</ion-header>

<ion-content>
    <ion-list class="listFixer">
        <stat *ngFor="let stat of (stats | async); let i = index" [stat]="stat" [index]="i"></stat>
        <!-- <div *ngFor="let stat of (stats | async); let i = index">
            <div *ngIf="(currentStat | async)?.id === stat.id; then editMode else viewMode"></div>
            <ng-template #viewMode>
                <ion-item-sliding>
                    <button ion-item (click)="selectStat(stat, i)" class="itemFixer">
                        <ion-grid class="statWrapper">
                            <ion-row col-12 class="stat" [ngClass]="{'visible': getVis(stat.value, stat.maximum)}">
                                <ion-col col-5 class="name">
                                    {{ stat.name }}
                                </ion-col>
                                <ion-col col-3 class="valueWrapper">
                                    <span class="value">
                                        {{ stat.value }}
                                    </span>
                                    <span class="maximum">
                                        {{ stat.maximum }}
                                    </span>
                                </ion-col>
                                <ion-col col-4 text-right class="type">
                                    {{ stat.type }}
                                </ion-col>
                            </ion-row>
                        </ion-grid>
                    </button>
                    <ion-item-options *ngIf="stat.maximum > 0 && stat.value < stat.maximum" side="left">
                        <button ion-button (click)="refresh(stat)">
                            <ion-icon name="refresh-circle">                          
                            </ion-icon>
                            Refresh
                        </button>
                    </ion-item-options>
                    <ion-item-options side="right">
                        <button ion-button (click)="removeStat(stat)">
                            <ion-icon name="trash">
                            </ion-icon>
                            Remove
                        </button>
                    </ion-item-options>
                </ion-item-sliding>
            </ng-template>
            <ng-template #editMode>
                <div *ngIf="stat.maximum > 0" [@activeRangeHeight] style="z-index: 0">
                        <ion-item>
                            <ion-range class="rangeSlider" min="0" max="{{rangeMax}}" [(ngModel)]="rangeValue" debounce="{{EVENTDEBOUNCE}}" (ionChange)="rangeChange(stat)">
                                <ion-label range-left class="rangeLeft">
                                    0
                                </ion-label>
                                <ion-label range-right class="rangeRight">
                                    {{rangeMax}}
                                </ion-label>
                            </ion-range>
                        </ion-item>
                    </div>
                <ion-item class="formEdit">
                    <form [formGroup]="editStatForm">
                        <div>
                            <ion-row>
                                <ion-col col-2>
                                    <button (click)="formChange(stat, 'MINUS', $event)" ion-button icon-only clear>
                                <ion-icon name="remove"></ion-icon>
                            </button>
                                </ion-col>
                                <ion-col col-8 class="formEditInput">
                                    <input type="number" placeholder="Change {{stat.value}} by" formControlName="value" #inputFocus/>
                                </ion-col>
                                <ion-col col-2>
                                    <button (click)="formChange(stat, 'PLUS', $event)" ion-button icon-only clear>
                                <ion-icon name="add" ></ion-icon>
                            </button>
                                </ion-col>
                            </ion-row>
                        </div>
                    </form>
                </ion-item>
            </ng-template>
        </div> -->
    </ion-list>
</ion-content>